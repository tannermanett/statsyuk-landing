
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NHL Offensive Profile Radar</title>
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Annotation Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0/dist/chartjs-plugin-annotation.min.js"></script>
    <!-- jsPDF Library for Exporting Charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* Base Styles */
        body {
            font-family: 'Roboto', sans-serif;
            background: #121212; /* Dark background */
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            color: #e0e0e0; /* Light text for contrast */
            transition: background 0.5s ease, color 0.5s ease;
        }

        h1 {
            color: #ffffff; /* White text for headings */
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Chart Container */
        .chart-container {
            background: #1e1e1e; /* Darker container background */
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            position: relative;
            height: 500px; /* Consistent height */
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        /* Filters Section */
        .filters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .filters select, .filters input[type="text"] {
            padding: 0.8rem 1.2rem;
            border-radius: 25px;
            border: 2px solid #3498db;
            background: #2c2c2c; /* Dark select background */
            color: #e0e0e0; /* Light text */
            font-size: 1rem;
            width: 200px;
            transition: all 0.3s ease;
            appearance: none; /* Remove default styling */
        }

        .filters select:hover, .filters input[type="text"]:hover {
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.5);
            background: #3a3a3a; /* Slightly lighter on hover */
        }

        /* Dropdown Arrow Customization */
        .filters select {
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="%23e0e0e0" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px 16px;
        }

        /* Remove the default arrow for IE */
        select::-ms-expand {
            display: none;
        }

        /* Summary Statistics Section */
        .summary-stats {
            background: #1e1e1e; /* Darker background */
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .summary-stats h2 {
            margin-bottom: 1rem;
            color: #ffffff;
        }

        .summary-stats p {
            margin: 0.5rem 0;
            font-size: 1rem;
        }

        /* Export Buttons */
        .export-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .export-buttons button {
            padding: 0.8rem 1.2rem;
            border: none;
            border-radius: 25px;
            background-color: #3498db;
            color: #fff;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .export-buttons button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.5);
        }

        /* Additional Charts Section (Optional) */
        .additional-charts {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            margin-top: 2rem;
            transition: all 0.3s ease;
        }

        @media (min-width: 768px) {
            .additional-charts {
                flex-direction: row;
            }
        }

        .additional-charts canvas {
            background: #1e1e1e;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            padding: 1rem;
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        /* Loading Spinner */
        #loadingSpinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }

        .spinner {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Feedback Form (Optional) */
        .feedback-form {
            background: #1e1e1e;
            color: #e0e0e0;
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .feedback-form h2 {
            margin-bottom: 1rem;
            color: #ffffff;
        }

        .feedback-form textarea {
            width: 100%;
            padding: 0.8rem;
            border-radius: 5px;
            border: 1px solid #3498db;
            background: #2c2c2c;
            color: #e0e0e0;
            resize: vertical;
            transition: background 0.3s ease, border 0.3s ease;
        }

        .feedback-form textarea:focus {
            background: #3a3a3a;
            border-color: #2980b9;
            outline: none;
        }

        .feedback-form button {
            margin-top: 1rem;
            padding: 0.8rem 1.2rem;
            border: none;
            border-radius: 25px;
            background-color: #3498db;
            color: #fff;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feedback-form button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.5);
        }
    </style>
</head>
<body>
    <h1>NHL Offensive Profile Radar</h1>

    <!-- Filters Section -->
    <div class="filters">
        <select id="positionSelect">
            <option value="All">All Positions</option>
            <option value="F">Forward (F)</option>
            <option value="D">Defense (D)</option>
            <option value="RW">Right Wing (RW)</option>
            <option value="C">Center (C)</option>
            <option value="LW">Left Wing (LW)</option>
            <option value="RD">Right Defense (RD)</option>
            <option value="LD">Left Defense (LD)</option>
        </select>

        <select id="strengthSelect">
            <option value="All">All Strengths</option>
            <option value="EV">Even Strength (EV)</option>
            <option value="PP">Powerplay (PP)</option>
            <option value="PK">Penalty Kill (PK)</option>
        </select>

        <input type="text" id="searchPlayer" placeholder="Search for a player...">
    </div>

    <!-- Chart Container -->
    <div class="chart-container">
        <canvas id="radarChart" aria-label="NHL Offensive Profile Radar Chart" role="img"></canvas>
    </div>

    <!-- Player Selection Dropdown -->
    <div class="filters">
        <select id="playerSelect">
            <option value="">Select a player</option>
            <!-- Player options will be populated dynamically -->
        </select>
    </div>

    <!-- Summary Statistics Section -->
    <div class="summary-stats">
        <h2>Player Summary</h2>
        <p>Select a player to view summary statistics.</p>
    </div>

    <!-- Export Buttons -->
    <div class="export-buttons">
        <button id="downloadRadar">Download Radar Chart</button>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <!-- Feedback Form (Optional) -->
    <div class="feedback-form">
        <h2>We Value Your Feedback</h2>
        <textarea id="userFeedback" placeholder="Share your thoughts..." rows="4"></textarea>
        <button id="submitFeedback">Submit Feedback</button>
    </div>

    <script>
        // Sample Data Structures

        // Position Averages: position -> strength -> array of stats
        const positionAverages = {
            "F": {
                "EV": [75, 70, 65, 80, 78, 85, 70, 75, 72, 80, 68, 82],
                "PP": [80, 75, 70, 85, 83, 90, 75, 80, 77, 85, 75, 88],
                "PK": [70, 65, 60, 75, 73, 80, 65, 70, 67, 75, 60, 78]
            },
            "D": {
                "EV": [70, 68, 65, 75, 72, 80, 60, 65, 62, 70, 58, 75],
                "PP": [75, 73, 70, 80, 78, 85, 65, 70, 67, 75, 65, 80],
                "PK": [65, 63, 60, 70, 68, 75, 55, 60, 57, 70, 55, 73]
            },
            "RW": {
                "EV": [78, 75, 70, 82, 80, 88, 72, 78, 75, 82, 70, 85],
                "PP": [83, 80, 75, 90, 88, 95, 77, 83, 80, 90, 75, 92],
                "PK": [73, 70, 65, 80, 78, 85, 67, 73, 70, 80, 65, 83]
            },
            "C": {
                "EV": [80, 78, 75, 85, 83, 90, 75, 80, 77, 85, 73, 88],
                "PP": [85, 83, 80, 95, 93, 100, 80, 85, 82, 95, 80, 98],
                "PK": [75, 73, 70, 85, 83, 90, 70, 75, 72, 85, 70, 88]
            },
            "LW": {
                "EV": [76, 73, 68, 80, 78, 85, 70, 75, 72, 80, 68, 82],
                "PP": [81, 78, 73, 88, 86, 93, 75, 80, 77, 88, 75, 90],
                "PK": [71, 68, 63, 78, 76, 83, 65, 70, 67, 78, 63, 81]
            },
            "RD": {
                "EV": [68, 65, 60, 72, 70, 78, 55, 60, 57, 72, 55, 75],
                "PP": [73, 70, 65, 80, 78, 85, 60, 65, 62, 80, 60, 83],
                "PK": [63, 60, 55, 70, 68, 75, 50, 55, 52, 70, 50, 73]
            },
            "LD": {
                "EV": [68, 65, 60, 72, 70, 78, 55, 60, 57, 72, 55, 75],
                "PP": [73, 70, 65, 80, 78, 85, 60, 65, 62, 80, 60, 83],
                "PK": [63, 60, 55, 70, 68, 75, 50, 55, 52, 70, 50, 73]
            }
        };

        // Player Data: array of player objects
        const players = [
            {
                name: 'Connor McDavid',
                position: 'C',
                strength: 'EV',
                percentiles: [97, 89, 76, 92, 88, 94, 85, 90, 87, 93, 84, 91],
                actualStats: [35, 45, 20, 80, 15, 2.5, 1.2, 0.8, 1.0, 1.5, 0.5, 40]
            },
            {
                name: 'Auston Matthews',
                position: 'RW',
                strength: 'Powerplay',
                percentiles: [85, 82, 74, 88, 85, 87, 78, 83, 80, 86, 79, 84],
                actualStats: [30, 40, 25, 75, 12, 2.0, 1.0, 0.7, 0.9, 1.3, 0.4, 35]
            },
            {
                name: 'Nathan MacKinnon',
                position: 'LW',
                strength: 'Penalty Kill',
                percentiles: [92, 87, 81, 90, 86, 91, 82, 88, 84, 89, 83, 87],
                actualStats: [32, 42, 22, 78, 14, 2.3, 1.1, 0.75, 0.95, 1.4, 0.45, 38]
            },
            {
                name: 'Sidney Crosby',
                position: 'C',
                strength: 'EV',
                percentiles: [90, 85, 80, 88, 82, 89, 75, 80, 78, 85, 80, 83],
                actualStats: [28, 38, 18, 76, 13, 2.2, 1.0, 0.7, 0.85, 1.2, 0.35, 36]
            },
            {
                name: 'Dylan Larkin',
                position: 'LW',
                strength: 'EV',
                percentiles: [88, 84, 78, 85, 80, 86, 73, 78, 75, 83, 77, 80],
                actualStats: [27, 37, 17, 74, 12, 2.0, 0.95, 0.65, 0.8, 1.1, 0.3, 34]
            }
            // Add more players as needed
        ];

        // Summary Statistics Element
        const summaryStats = document.querySelector('.summary-stats');

        // Get DOM Elements
        const positionSelect = document.getElementById('positionSelect');
        const strengthSelect = document.getElementById('strengthSelect');
        const playerSelect = document.getElementById('playerSelect');
        const searchPlayer = document.getElementById('searchPlayer');
        const downloadRadar = document.getElementById('downloadRadar');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const submitFeedback = document.getElementById('submitFeedback');

        // Initialize Filters and Player Dropdown
        function initializeFilters() {
            populatePlayerDropdown();
        }

        // Populate Player Dropdown based on selected filters
        function populatePlayerDropdown() {
            const selectedPosition = positionSelect.value;
            const selectedStrength = strengthSelect.value;
            const searchQuery = searchPlayer.value.toLowerCase();

            // Clear existing options
            playerSelect.innerHTML = '<option value="">Select a player</option>';

            // Filter players based on position, strength, and search query
            const filteredPlayers = players.filter(player => {
                const matchesPosition = selectedPosition === 'All' || player.position === selectedPosition;
                const matchesStrength = selectedStrength === 'All' || player.strength === selectedStrength;
                const matchesSearch = player.name.toLowerCase().includes(searchQuery);
                return matchesPosition && matchesStrength && matchesSearch;
            });

            // Populate dropdown with filtered players
            filteredPlayers.forEach(player => {
                const option = document.createElement('option');
                option.value = player.name;
                option.textContent = player.name;
                playerSelect.appendChild(option);
            });
        }

        // Event Listeners for Filters
        positionSelect.addEventListener('change', populatePlayerDropdown);
        strengthSelect.addEventListener('change', populatePlayerDropdown);
        searchPlayer.addEventListener('input', populatePlayerDropdown);

        // Initialize Chart with Default Position and Strength
        const ctx = document.getElementById('radarChart').getContext('2d');

        // Function to get Position Average based on selected position and strength
        function getPositionAverage(position, strength) {
            if (position === 'All' || strength === 'All') {
                // Calculate overall league average
                const allAverages = [];
                for (const pos in positionAverages) {
                    for (const str in positionAverages[pos]) {
                        positionAverages[pos][str].forEach((value, index) => {
                            allAverages[index] = (allAverages[index] || 0) + value;
                        });
                    }
                }
                return allAverages.map(total => Math.round(total / (Object.keys(positionAverages).length * 3)));
            } else {
                return positionAverages[position][strength];
            }
        }

        // Initialize Radar Chart
        let radarChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: [
                    'Goals', 'Primary Assists', 'Secondary Assists', 'Shots on Goal', 
                    'Shooting %', 'xG', 'Flurry xG', 'Low Danger xG', 
                    'Medium Danger xG', 'High Danger xG', 'Rebound xG', 'Assists'
                ],
                datasets: [
                    {
                        label: 'Position Average',
                        data: getPositionAverage('All', 'All'),
                        backgroundColor: 'rgba(149, 165, 166, 0.1)',
                        borderColor: 'rgba(149, 165, 166, 0.8)',
                        borderWidth: 1.5,
                        pointRadius: 0,
                        borderDash: [5, 5]
                    },
                    {
                        label: 'Selected Player',
                        data: [], // To be populated when a player is selected
                        backgroundColor: 'rgba(52, 152, 219, 0.2)',
                        borderColor: '#3498db',
                        borderWidth: 2.5,
                        pointBackgroundColor: '#ffffff',
                        pointBorderColor: '#3498db',
                        pointHoverRadius: 8,
                        pointRadius: 5
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 1500,
                    easing: 'easeOutQuart'
                },
                scales: {
                    r: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)',
                            lineWidth: 1.5
                        },
                        angleLines: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        },
                        pointLabels: {
                            font: {
                                size: 12,
                                weight: '500'
                            },
                            color: '#e0e0e0'
                        },
                        ticks: {
                            display: false,
                            backdropColor: 'transparent',
                            stepSize: 20
                        }
                    }
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            color: '#e0e0e0',
                            font: {
                                size: 14,
                                weight: '600'
                            },
                            padding: 20
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.95)',
                        titleFont: { size: 14, weight: '600' },
                        bodyFont: { size: 13 },
                        padding: 12,
                        cornerRadius: 8,
                        displayColors: false,
                        callbacks: {
                            title: function(context) {
                                return context[0].dataset.label;
                            },
                            label: function(context) {
                                const datasetLabel = context.dataset.label || '';
                                const percentile = context.formattedValue;
                                const category = context.label;
                                const player = datasetLabel;
                                const selectedPlayer = players.find(p => p.name === player);
                                const actualStat = selectedPlayer ? selectedPlayer.actualStats[context.dataIndex] : 'N/A';
                                return `${category}: ${percentile}th percentile (Actual: ${actualStat})`;
                            }
                        }
                    },
                    annotation: {
                        annotations: [
                            {
                                type: 'line',
                                mode: 'horizontal',
                                scaleID: 'r',
                                value: 90,
                                borderColor: 'red',
                                borderWidth: 2,
                                label: {
                                    enabled: true,
                                    content: 'Elite Threshold',
                                    position: 'center',
                                    backgroundColor: 'rgba(255, 99, 132, 0.8)',
                                    color: '#fff',
                                    font: {
                                        weight: 'bold'
                                    }
                                }
                            }
                        ]
                    }
                }
            }
        });

        // Function to update Position Average based on filters
        function updatePositionAverage() {
            const selectedPosition = positionSelect.value;
            const selectedStrength = strengthSelect.value;
            const newAverage = getPositionAverage(selectedPosition, selectedStrength);
            radarChart.data.datasets[0].data = newAverage;
            radarChart.update();
        }

        // Event Listeners for Filters to Update Position Average
        positionSelect.addEventListener('change', () => {
            updatePositionAverage();
            populatePlayerDropdown();
        });

        strengthSelect.addEventListener('change', () => {
            updatePositionAverage();
            populatePlayerDropdown();
        });

        // Function to update Radar Chart with Selected Player Data
        function updateRadarChart(selectedPlayerName) {
            const selectedPlayer = players.find(player => player.name === selectedPlayerName);
            if (selectedPlayer) {
                radarChart.data.datasets[1].data = selectedPlayer.percentiles;
                radarChart.data.datasets[1].label = selectedPlayer.name;
                radarChart.update();
                updateSummaryStats(selectedPlayer);
            }
        }

        // Function to Update Summary Statistics
        function updateSummaryStats(player) {
            summaryStats.innerHTML = `
                <h2>${player.name} Summary</h2>
                <p><strong>Position:</strong> ${getPositionFullName(player.position)}</p>
                <p><strong>Strength:</strong> ${getStrengthFullName(player.strength)}</p>
                <p><strong>Goals:</strong> ${player.actualStats[0]}</p>
                <p><strong>Primary Assists:</strong> ${player.actualStats[1]}</p>
                <p><strong>Secondary Assists:</strong> ${player.actualStats[2]}</p>
                <p><strong>Shots on Goal:</strong> ${player.actualStats[3]}</p>
                <p><strong>Shooting %:</strong> ${player.actualStats[4]}%</p>
                <p><strong>xG:</strong> ${player.actualStats[5]}</p>
                <p><strong>Flurry xG:</strong> ${player.actualStats[6]}</p>
                <p><strong>Low Danger xG:</strong> ${player.actualStats[7]}</p>
                <p><strong>Medium Danger xG:</strong> ${player.actualStats[8]}</p>
                <p><strong>High Danger xG:</strong> ${player.actualStats[9]}</p>
                <p><strong>Rebound xG:</strong> ${player.actualStats[10]}</p>
                <p><strong>Assists:</strong> ${player.actualStats[11]}</p>
            `;
        }

        // Helper Functions to Get Full Names
        function getPositionFullName(position) {
            const positionMap = {
                "F": "Forward",
                "D": "Defense",
                "RW": "Right Wing",
                "C": "Center",
                "LW": "Left Wing",
                "RD": "Right Defense",
                "LD": "Left Defense"
            };
            return positionMap[position] || position;
        }

        function getStrengthFullName(strength) {
            const strengthMap = {
                "EV": "Even Strength",
                "PP": "Powerplay",
                "PK": "Penalty Kill"
            };
            return strengthMap[strength] || strength;
        }

        // Event Listener for Player Selection
        playerSelect.addEventListener('change', function(e) {
            const selectedPlayer = e.target.value;
            updateRadarChart(selectedPlayer);
        });

        // Search Functionality for Player Dropdown
        searchPlayer.addEventListener('input', populatePlayerDropdown);

        // Function to Export Radar Chart as Image
        downloadRadar.addEventListener('click', function() {
            const link = document.createElement('a');
            link.href = radarChart.toBase64Image();
            link.download = 'NHL_Offensive_Profile_Radar.png';
            link.click();
        });

        // Initialize Filters on Page Load
        window.addEventListener('DOMContentLoaded', initializeFilters);

        // Feedback Form Submission (Optional)
        submitFeedback.addEventListener('click', function() {
            const feedback = document.getElementById('userFeedback').value.trim();
            if (feedback === "") {
                alert("Please enter your feedback before submitting.");
                return;
            }

            // Show loading spinner
            loadingSpinner.style.display = 'block';

            // Simulate sending feedback (Replace with actual API call)
            setTimeout(() => {
                alert("Thank you for your feedback!");
                document.getElementById('userFeedback').value = "";
                loadingSpinner.style.display = 'none';
            }, 1000);
        });

        // Function to Export Summary Statistics as PDF
        // (Optional Enhancement)
        /*
        const downloadSummaryPDF = document.createElement('button');
        downloadSummaryPDF.textContent = 'Download Summary PDF';
        downloadSummaryPDF.style.marginTop = '1rem';
        downloadSummaryPDF.style.padding = '0.8rem 1.2rem';
        downloadSummaryPDF.style.border = 'none';
        downloadSummaryPDF.style.borderRadius = '25px';
        downloadSummaryPDF.style.backgroundColor = '#2ecc71';
        downloadSummaryPDF.style.color = '#fff';
        downloadSummaryPDF.style.fontSize = '1rem';
        downloadSummaryPDF.style.cursor = 'pointer';
        downloadSummaryPDF.style.transition = 'transform 0.3s ease, box-shadow 0.3s ease';
        downloadSummaryPDF.addEventListener('mouseenter', () => {
            downloadSummaryPDF.style.transform = 'scale(1.05)';
            downloadSummaryPDF.style.boxShadow = '0 4px 8px rgba(46, 204, 113, 0.5)';
        });
        downloadSummaryPDF.addEventListener('mouseleave', () => {
            downloadSummaryPDF.style.transform = 'scale(1)';
            downloadSummaryPDF.style.boxShadow = 'none';
        });
        summaryStats.appendChild(downloadSummaryPDF);

        downloadSummaryPDF.addEventListener('click', function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            doc.setFontSize(18);
            doc.text('NHL Offensive Profile Radar Report', 14, 22);

            // Add Radar Chart Image
            const radarChartImage = radarChart.toBase64Image();
            doc.addImage(radarChartImage, 'PNG', 15, 30, 180, 160);

            // Add Summary Statistics
            doc.setFontSize(12);
            doc.text(summaryStats.innerText, 14, 200);

            // Save the PDF
            doc.save('NHL_Offensive_Profile_Report.pdf');
        });
        */

    </script>
</body>
</html>
